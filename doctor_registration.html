<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Practitioner Registration</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* {
  box-sizing: border-box;
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
}
body {
  margin: 0;
  background: linear-gradient(135deg, #e0f2fe, #f0fdf4);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}
.container {
  background: #ffffff;
  width: 100%;
  max-width: 850px;
  padding: 32px;
  border-radius: 14px;
  box-shadow: 0 12px 28px rgba(0, 0, 0, 0.12);
}
h2 { text-align:center; color:#0f172a; }
.subtitle { text-align:center; color:#64748b; margin-bottom:28px; }
.section-title {
  margin:26px 0 14px;
  font-weight:600;
  color:#065f46;
  border-left:4px solid #22c55e;
  padding-left:10px;
}
.form-grid {
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:16px;
}
.full-width { grid-column:1/-1; }
label { font-size:14px; margin-bottom:6px; display:block; }
input {
  width:100%;
  padding:11px 12px;
  border-radius:8px;
  border:1px solid #cbd5e1;
}
.otp-row { display:flex; gap:12px; align-items:flex-end; }
.documents-wrapper { display:flex; flex-direction:column; gap:14px; }
.document-row {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:16px 18px;
  border:1px solid #e2e8f0;
  border-radius:10px;
  background:#f8fafc;
}
.doc-btn {
  padding:9px 18px;
  background:#13a147;
  color:#fff;
  border-radius:6px;
  font-size:13px;
  font-weight:600;
  cursor:pointer;
  border:none;
}
.doc-btn:disabled {
  opacity: 0.8;
  cursor: default;
}
.submit-btn {
  width: 100%;
  margin-top: 32px;
  padding: 15px;
  border: none;
  border-radius: 10px;
  font-size: 16px;
  font-weight: 600;
  transition: all 0.3s ease;
}

/* DEFAULT PAGE LOAD â€” DISABLED */
.submit-btn:disabled {
  background: #e5e7eb;   /* light grey */
  color: #9ca3af;
  cursor: not-allowed;
  box-shadow: none;
}

/* ONLY WHEN ALL FIELDS ARE COMPLETE */
.submit-btn:not(:disabled) {
  background: linear-gradient(135deg, #22c55e, #15803d);
  color: #ffffff;
  cursor: pointer;
}

/* HOVER ONLY WHEN ENABLED */
.submit-btn:not(:disabled):hover {
  box-shadow: 0 8px 20px rgba(34, 197, 94, 0.45);
  transform: translateY(-1px);
}

</style>
</head>

<body>

<div class="container">
  <h2>Practitioner Registration</h2>
  <p class="subtitle">Join Dr.ViKi platform as a certified AYUSH practitioner</p>

  <form id="registrationForm" enctype="multipart/form-data">

    <div class="section-title">Account Details</div>
    <div class="form-grid">
      <div class="full-width">
        <label>Email</label>
        <input type="email" name="email" required>
      </div>
    </div>

    <div class="section-title">Personal Details</div>
    <div class="form-grid">
      <div>
        <label>First Name</label>
        <input type="text" name="firstName" required>
      </div>
      <div>
        <label>Last Name</label>
        <input type="text" name="lastName" required>
      </div>
      <div>
        <label>Date of Birth</label>
        <input type="date" name="dateOfBirth" required>
      </div>
      <div>
        <label>Pin Code</label>
        <input type="text" name="pinCode" required>
      </div>

      <div class="full-width otp-row">
        <div style="flex:1">
          <label>WhatsApp Number</label>
          <input type="text" name="whatsappNumber" required>
        </div>
        <!-- MODIFIED BUTTON -->
        <button type="button" id="sendOtpBtn" class="doc-btn">Send OTP</button>
      </div>
    </div>

    <div class="section-title">Documents</div>

    <div class="documents-wrapper">
      <div class="document-row">
        <div class="document-info">
          <h4>Degree Certificates</h4>
          <p>Upload PDF files</p>
        </div>
        <input type="file" id="degreeFile" multiple accept=".pdf" hidden>
        <label for="degreeFile" class="doc-btn" id="degreeLabel">Upload PDF</label>
      </div>

      <div class="document-row">
        <div class="document-info">
          <h4>Professional Photo</h4>
          <p>JPG or PNG</p>
        </div>
        <input type="file" id="photoFile" accept=".jpg,.jpeg,.png" hidden>
        <label for="photoFile" class="doc-btn" id="photoLabel">Upload Photo</label>
      </div>
    </div>

    <button type="submit" class="submit-btn" disabled>Complete Registration</button>
  </form>
</div>

<script>
const form = document.getElementById("registrationForm");
const submitBtn = document.querySelector(".submit-btn");
const sendOtpBtn = document.getElementById("sendOtpBtn");

const degreeFile = document.getElementById("degreeFile");
const photoFile = document.getElementById("photoFile");
const degreeLabel = document.getElementById("degreeLabel");
const photoLabel = document.getElementById("photoLabel");

let otpVerified = false;

/* FILE DISPLAY */
degreeFile.addEventListener("change", () => {
  degreeLabel.textContent =
    degreeFile.files.length ? `${degreeFile.files.length} file(s) selected` : "Upload PDF";
  checkFormValidity();
});

photoFile.addEventListener("change", () => {
  photoLabel.textContent =
    photoFile.files.length ? photoFile.files[0].name : "Upload Photo";
  checkFormValidity();
});

/* VALIDATION */
function checkFormValidity() {
  const valid =
    form.email.value &&
    form.firstName.value &&
    form.lastName.value &&
    form.dateOfBirth.value &&
    form.pinCode.value &&
    form.whatsappNumber.value &&
    degreeFile.files.length &&
    photoFile.files.length &&
    otpVerified;

  submitBtn.disabled = !valid;
  submitBtn.style.opacity = valid ? "1" : "0.6";
}

form.querySelectorAll("input").forEach(i =>
  i.addEventListener("input", checkFormValidity)
);

/* OTP */
sendOtpBtn.addEventListener("click", async () => {
  const number = form.whatsappNumber.value.trim();
  if (!number) return alert("Enter WhatsApp number");

  await fetch("http://localhost:5000/api/send-otp", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ whatsappNumber: number })
  });

  const otp = prompt("Enter OTP");
  if (!otp) return;

  const res = await fetch("http://localhost:5000/api/verify-otp", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ whatsappNumber: number, otp })
  });

  if (res.ok) {
    otpVerified = true;
    sendOtpBtn.textContent = "OTP Verified";
    sendOtpBtn.disabled = true;
    checkFormValidity();
  } else {
    alert("Invalid OTP");
  }
});
</script>

</body>
</html>
